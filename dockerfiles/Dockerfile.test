FROM node:18-alpine3.16 as builder

ARG REACT_APP_ENVIRONMENT
ARG REACT_APP_API_URL
ARG REACT_APP_SENTRY_DSN

ARG REACT_APP_CLIMATE_API_BASE_URL
ARG REACT_APP_CLIMATE_API_PUBLIC_KEY
ARG REACT_APP_CLIMATE_API_PRIVATE_KEY
ARG REACT_APP_CLIMATE_STATION_ID

ENV REACT_APP_ENVIRONMENT=${REACT_APP_ENVIRONMENT:-local}
ENV REACT_APP_API_URL=${REACT_APP_API_URL}
ENV REACT_APP_SENTRY_DSN=${REACT_APP_SENTRY_DSN}

ENV REACT_APP_CLIMATE_API_BASE_URL=${REACT_APP_CLIMATE_API_BASE_URL}
ENV REACT_APP_CLIMATE_API_PUBLIC_KEY=${REACT_APP_CLIMATE_API_PUBLIC_KEY}
ENV REACT_APP_CLIMATE_API_PRIVATE_KEY=${REACT_APP_CLIMATE_API_PRIVATE_KEY}
ENV REACT_APP_CLIMATE_STATION_ID=${REACT_APP_CLIMATE_STATION_ID}

WORKDIR /app

COPY package.json .

RUN yarn install

COPY . .

RUN yarn build
CMD [ "yarn start" ]
